import{v as le,c as ne,E as x,z as ie,r as C,l as se,m as re,n as de,q as ce,p as ue,x as pe,y as me,A as fe,d as ge,B as _e,C as ye,s as he,t as be,o as xe,u as ve}from"./_element-plus-37671e98.js";import{a6 as R,a9 as we}from"./__vendor-1966d9c6.js";import{u as V,l as U}from"../js2/app-485f8aa4.js";import{S as Ce,T as ke,U as Ee}from"./_@element-plus-51f61cc2.js";import{z as j,j as F,o as E,c as M,E as t,$ as De,r as k,x as Se,y as ze,i as Fe,a4 as a,u as l,a7 as h,a5 as Le,a3 as N,L as Te,a as D}from"./_@vue-37f9eba6.js";const L=R.create();let _=null;L.interceptors.request.use(e=>{var o,c;const{token:n,axiosPromiseArr:i}=V();return e.cancelToken=new R.CancelToken(u=>{i.push({url:e.url,cancel:u})}),e.headers.AUTHORIZE_TOKEN=n,"get".includes((o=e.method)==null?void 0:o.toLowerCase())&&(e.params=e.data),((c=e.reqLoading)==null||c)&&(_=le.service({lock:!0,fullscreen:!0,text:"loading...",background:"rgba(0, 0, 0, 0.3)"})),e},e=>{Promise.reject(e)});L.interceptors.response.use(e=>{var u;if(_&&_&&_.close(),["application/zip","zip","blob","arraybuffer"].includes(e.headers["content-type"]))return e;const{code:n,msg:i}=e.data,o="0,200,20000",c="401,403";return o.includes(e.status)?e:(c.includes(n)&&ne.confirm(U("relogin_title"),{confirmButtonText:U("relogin"),closeOnClickModal:!1,showCancelButton:!1,showClose:!1,type:"warning"}).then(()=>{V().resetStateAndToLogin()}),(u=e.config)!=null&&u.isNotTipErrorMsg||x.error({message:i,duration:2*1e3}),Promise.reject(i))},e=>(_&&_&&_.close(),x.error({message:e,duration:2*1e3}),Promise.reject(e)));function T(e){return L({baseURL:"/",timeout:8e3,...e})}const Ie=e=>T({url:"/api/products",method:"get",params:e}),Pe=e=>{const n=new FormData;return n.append("file",e),T({url:"/api/products/import",method:"post",data:n,headers:{"Content-Type":"multipart/form-data"}})};function Be(){return T({url:"/api/products/import/template/download",method:"get",responseType:"arraybuffer"})}const Ue=j({__name:"index",props:{total:{required:!0,type:Number,default:0},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},emits:["update:page","update:limit","pagination"],setup(e,{emit:n}){const i=e,o=F({get:()=>i.page,set:d=>{n("update:page",d)}}),c=F({get(){return i.limit},set(d){n("update:limit",d)}});function u(d){n("pagination",{page:o,limit:d}),i.autoScroll}function y(d){o.value=d,n("pagination",{page:d,limit:i.limit}),i.autoScroll}return(d,f)=>{const I=ie;return E(),M("div",{class:De([{hidden:e.hidden},"pagination-container"])},[t(I,{background:e.background,"current-page":o.value,"onUpdate:currentPage":f[0]||(f[0]=b=>o.value=b),"page-size":c.value,"onUpdate:pageSize":f[1]||(f[1]=b=>c.value=b),layout:e.layout,"page-sizes":e.pageSizes,total:e.total,onSizeChange:u,onCurrentChange:y},null,8,["background","current-page","page-size","layout","page-sizes","total"])],2)}}});const Ne=we(Ue,[["__scopeId","data-v-001d26f5"]]),Re={class:"app-container"},Ve=D("div",{class:"el-upload__text"},[h(" Drop your file here or "),D("em",null,"click to upload")],-1),je=D("div",{class:"el-upload__tip"},"xls/xlsx files",-1),Me={class:"dialog-footer"},Qe=j({__name:"Dashboard",setup(e){k(C),k(C);const n=k(C),i=k("");F(()=>d.value.filter(s=>!i.value||s.name.toLowerCase().includes(i.value.toLowerCase())));const o=Se({loading:!0,ids:[],total:0,productList:[],dialog:{visible:!1},queryParams:{pageNum:1,pageSize:10},rules:{},importDialog:{title:"Product Import",visible:!1},importFormData:{},excelFile:void 0,excelFilelist:[]}),{ids:c,loading:u,queryParams:y,productList:d,total:f,dialog:I,rules:b,importDialog:v,importFormData:A,excelFilelist:O}=ze(o);function S(){o.loading=!0,Ie(o.queryParams).then(({data:s})=>{o.productList=s.data,o.total=s.meta.total,o.loading=!1})}function q(s){o.ids=s.map(r=>r.id)}function X(){Be().then(s=>{const r=new Blob([s.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"}),p=document.createElement("a"),w=window.URL.createObjectURL(r);p.href=w,p.download=decodeURI(s.headers["content-disposition"].split(";")[1].split("=")[1]),document.body.appendChild(p),p.click(),document.body.removeChild(p),window.URL.revokeObjectURL(w)})}async function $(){v.value.visible=!0}function Q(s){if(!/\.(xlsx|xls|XLSX|XLS)$/.test(s.name))return x.warning("upload file must be Excel format ex: xlsx, xls"),o.excelFile=void 0,o.excelFilelist=[],!1;o.excelFile=s.raw}function H(){n.value.validate(s=>{if(s){if(!o.excelFile)return x.warning("import excel file cannot be empty"),!1;Pe(o.excelFile).then(r=>{x.success(r.data),z(),S()})}})}function z(){o.importDialog.visible=!1,o.excelFile=void 0,o.excelFilelist=[],n.value.resetFields()}return Fe(()=>{S()}),(s,r)=>{const p=se,w=re,K=de,P=ce,Z=ue,m=pe,G=me,J=fe,W=he,Y=be,ee=ge,te=_e,B=xe,oe=ve,ae=ye;return E(),M("div",Re,[t(Y,{gutter:20},{default:a(()=>[t(W,{span:24},{default:a(()=>[t(J,{shadow:"never"},{header:a(()=>[t(P,null,{default:a(()=>[t(K,{"split-button":""},{dropdown:a(()=>[t(w,null,{default:a(()=>[t(p,{icon:l(Ce),onClick:X},{default:a(()=>[h("Download Sample")]),_:1},8,["icon"]),t(p,{icon:l(ke),onClick:$},{default:a(()=>[h("Import")]),_:1},8,["icon"])]),_:1})]),default:a(()=>[h(" Import ")]),_:1})]),_:1})]),default:a(()=>[Le((E(),N(G,{data:l(d),onSelectionChange:q},{header:a(()=>[t(Z,{modelValue:i.value,"onUpdate:modelValue":r[0]||(r[0]=g=>i.value=g),size:"small",placeholder:"Type to search"},null,8,["modelValue"])]),default:a(()=>[t(m,{type:"selection",width:"50",align:"center"}),t(m,{key:"id",label:"ID",align:"center",prop:"id",width:"100"}),t(m,{key:"product_id",label:"Product ID",align:"center",prop:"product_id"}),t(m,{key:"type",label:"Types",align:"center",prop:"type"}),t(m,{key:"brand",label:"Brand",align:"center",prop:"brand"}),t(m,{key:"model",label:"Model",align:"center",prop:"model"}),t(m,{key:"capacity",label:"Capacity",align:"center",prop:"capacity"}),t(m,{key:"quantity",label:"Quantity",align:"center",prop:"quantity"})]),_:1},8,["data"])),[[ae,l(u)]]),l(f)>0?(E(),N(Ne,{key:0,total:l(f),page:l(y).pageNum,"onUpdate:page":r[1]||(r[1]=g=>l(y).pageNum=g),limit:l(y).pageSize,"onUpdate:limit":r[2]||(r[2]=g=>l(y).pageSize=g),onPagination:S},null,8,["total","page","limit"])):Te("",!0)]),_:1})]),_:1})]),_:1}),t(oe,{title:l(v).title,modelValue:l(v).visible,"onUpdate:modelValue":r[3]||(r[3]=g=>l(v).visible=g),width:"600px","append-to-body":"",onClose:z},{footer:a(()=>[D("div",Me,[t(B,{type:"primary",onClick:H},{default:a(()=>[h("Confirm")]),_:1}),t(B,{onClick:z},{default:a(()=>[h("Cancel")]),_:1})])]),default:a(()=>[t(l(C),{ref_key:"importFormRef",ref:n,model:l(A),rules:l(b),"label-width":"80px"},{default:a(()=>[t(P,{label:"Excel"},{default:a(()=>[t(te,{class:"upload-demo",action:"",drag:"","auto-upload":!1,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","file-list":l(O),"on-change":Q,limit:1},{tip:a(()=>[je]),default:a(()=>[t(ee,{class:"el-icon--upload"},{default:a(()=>[t(l(Ee))]),_:1}),Ve]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Qe as default};
//# sourceMappingURL=Dashboard-5a8d578f.js.map
