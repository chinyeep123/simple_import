{"version":3,"file":"Login-2f2d708f.js","sources":["../../../resources/js/views/auth/Install.vue","../../../resources/js/views/auth/Login.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-button\r\n      class=\"add-button\"\r\n      id=\"install\"\r\n      v-if=\"buttonCss\"\r\n      @click=\"butonClick\"\r\n    >\r\n      Install App\r\n    </el-button>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, ref } from 'vue'\r\n\r\nconst deferredPrompt = ref(null)\r\nconst buttonCss = ref(false)\r\nconst butonClick = async () => {\r\n    if (!deferredPrompt.value) {\r\n        return;\r\n    }\r\n    const result = await deferredPrompt.value.prompt();\r\n    console.log(`Install prompt was: ${result.outcome}`);\r\n    deferredPrompt.value = null;\r\n    showInAppInstallPromotion();\r\n    installButton.setAttribute(\"hidden\", \"\");\r\n}\r\nonMounted(() => {\r\n  \r\nvar _beforeInstallPrompt; \r\n\r\nif ( \"onbeforeinstallprompt\" in window ) { \r\n  console.log('aa')\r\nwindow.addEventListener( \"beforeinstallprompt\", beforeInstallPrompt ); \r\n} \r\n\r\nfunction beforeInstallPrompt( evt ) { \r\nevt.preventDefault(); _beforeInstallPrompt = evt; \r\n}\r\n \r\n    window.addEventListener(\"beforeinstallprompt\", (event) => {\r\n        console.log('e', event)\r\n        event.preventDefault();\r\n        deferredPrompt.value = event;\r\n        buttonCss.value = true\r\n        // installButton.removeAttribute(\"hidden\");\r\n    });\r\n    if ( window.addToHomescreen ) { \r\n      ath = addToHomescreen( { \r\n      onCanInstall: function ( platform, _instance ) { \r\n      //run any on screen prompting logic from here \r\n      console.log('aaa', _instance)\r\n      },\r\n      onBeforeInstallPrompt: function ( platform ) { \r\n      //this triggers in response to the browser triggering the beforeInstallPrompt event \r\n      console.log( \"native prompt: \", platform ); \r\n      }\r\n      } ); \r\n      }\r\n});\r\n</script>","<!--suppress ALL -->\r\n<template>\r\n  <div class=\"login-container\">\r\n    <el-form ref=\"refLoginForm\" class=\"login-form\" :model=\"subForm\" :rules=\"formRules\">\r\n      <div class=\"title-container\">\r\n        <h3 class=\"title text-center\">{{ settings.title }}</h3>\r\n      </div>\r\n        <el-form-item prop=\"keyword\" :rules=\"formRules.isNotNull(langTitle('username_validate'))\">\r\n                <span class=\"svg-container\">\r\n                    <svg-icon icon-class=\"user\" />\r\n                </span>\r\n            <el-input v-model=\"subForm.keyword\" placeholder=\"username(admin)\" />\r\n            <!--占位-->\r\n            <div class=\"show-pwd\" />\r\n        </el-form-item>\r\n      <!--<el-form-item prop=\"password\" :rules=\"formRules.passwordValid\">-->\r\n      <el-form-item prop=\"password\" :rules=\"formRules.isNotNull(langTitle('username_validate'))\">\r\n          <span class=\"svg-container\">\r\n            <svg-icon icon-class=\"password\" />\r\n          </span>\r\n          <el-input\r\n            :key=\"passwordType\"\r\n            ref=\"refPassword\"\r\n            v-model=\"subForm.password\"\r\n            :type=\"passwordType\"\r\n            name=\"password\"\r\n            placeholder=\"password(123456)\"\r\n            @keyup.enter=\"handleLogin\"\r\n          />\r\n          <span class=\"show-pwd\" @click=\"showPwd\">\r\n            <svg-icon :icon-class=\"passwordType === 'password' ? 'eye' : 'eye-open'\" />\r\n          </span>\r\n      </el-form-item>\r\n      <div class=\"tip-message\">{{ tipMessage }}</div>\r\n      <el-button :loading=\"subLoading\" type=\"primary\" class=\"login-btn\" size=\"default\" @click.prevent=\"handleLogin\">\r\n        Login\r\n      </el-button>\r\n      <Install />\r\n      <vue-qr text=\"https://simple-import.comecodetogether.com\" :callback=\"openQR\" qid=\"testid\"></vue-qr>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { nextTick, reactive, ref, watch } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { useBasicStore } from '@/store/auth'\r\nimport { elMessage, useElement } from '@/hooks/use-element'\r\nimport { langTitle } from '@/hooks/use-common'\r\nimport vueQr from 'vue-qr/src/packages/vue-qr.vue'\r\nimport Install from './Install.vue'\r\n\r\n    /* listen router change and set the query  */\r\n    const { settings } = useBasicStore()\r\n    const route = useRoute()\r\n    //element valid\r\n    const formRules = useElement().formRules\r\n    //form\r\n    const subForm = reactive({\r\n        keyword: 'admin',\r\n        password: '123456'\r\n    })\r\n    const state = reactive({\r\n        otherQuery: {},\r\n        redirect: undefined\r\n    })\r\n    const openQR = (dataUrl,id) => {\r\n      console.log('can')\r\n    }\r\n    const getOtherQuery = (query) => {\r\n        return Object.keys(query).reduce((acc, cur) => {\r\n            if (cur !== 'redirect') {\r\n            acc[cur] = query[cur]\r\n            }\r\n            return acc\r\n        }, {})\r\n    }\r\n\r\n    watch( () => route.query, (query) => {\r\n        if (query) {\r\n            state.redirect = query.redirect\r\n            state.otherQuery = getOtherQuery(query)\r\n        }\r\n    },\r\n    { immediate: true }\r\n    )\r\n\r\n    /*\r\n    *  login relative\r\n    * */\r\n    let subLoading = ref(false)\r\n    //tip message\r\n    let tipMessage = ref('')\r\n    //sub form\r\n    const refLoginForm = ref(null)\r\n    const handleLogin = () => {\r\n    refLoginForm.value.validate((valid) => {\r\n        subLoading = true\r\n        if (valid) loginFunc()\r\n    })\r\n    }\r\n    const router = useRouter()\r\n    const basicStore = useBasicStore()\r\n\r\n    const loginFunc = () => {\r\n        basicStore.setLogin(true)\r\n        router.push('/')\r\n    }\r\n\r\n    /*\r\n    *  password show or hidden\r\n    * */\r\n    const passwordType = ref('password')\r\n    const refPassword = ref(null)\r\n    const showPwd = () => {\r\n    if (passwordType.value === 'password') {\r\n        passwordType.value = ''\r\n    } else {\r\n        passwordType.value = 'password'\r\n    }\r\n    nextTick(() => {\r\n        refPassword.value.focus()\r\n    })\r\n    }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n$bg: #2d3a4b;\r\n$dark_gray: #889aa4;\r\n$light_gray: #eee;\r\n$cursor: #fff;\r\n.login-container {\r\n  height: 100vh;\r\n  width: 100%;\r\n  background-color: #2d3a4b;\r\n    overflow: hidden;\r\n  .login-form {\r\n    position: relative;\r\n    width: 520px;\r\n    max-width: 100%;\r\n    padding: 160px 35px 0;\r\n    margin: 0 auto;\r\n    overflow: hidden;\r\n  }\r\n  .title-container {\r\n    .title {\r\n      font-size: 26px;\r\n      color: #eee;\r\n      margin: 0px auto 25px auto;\r\n      text-align: center;\r\n      font-weight: bold;\r\n    }\r\n  }\r\n  .el-input {\r\n    display: inline-block;\r\n    height: 47px;\r\n    width: 85%;\r\n    input {\r\n      background: transparent;\r\n      border: 0px;\r\n      -webkit-appearance: none;\r\n      border-radius: 0px;\r\n      padding: 12px 5px 12px 15px;\r\n      color: $light_gray;\r\n      height: 47px;\r\n      caret-color: $cursor;\r\n\r\n      &:-webkit-autofill {\r\n        box-shadow: 0 0 0px 1000px $bg inset !important;\r\n        -webkit-text-fill-color: $cursor !important;\r\n      }\r\n    }\r\n  }\r\n  .el-form-item {\r\n    border: 1px solid rgba(255, 255, 255, 0.1);\r\n    background: rgba(0, 0, 0, 0.1);\r\n    border-radius: 5px;\r\n    color: #454545;\r\n  }\r\n}\r\n\r\n.svg-container {\r\n    padding: 6px 5px 6px 15px;\r\n    color: $dark_gray;\r\n    text-align: center;\r\n    vertical-align: middle;\r\n    width: 30px;\r\n    display: inline-block;\r\n}\r\n\r\n//错误提示信息\r\n.tip-message {\r\n  color: #e4393c;\r\n  height: 30px;\r\n  margin-top: -12px;\r\n  font-size: 12px;\r\n}\r\n\r\n//登录按钮\r\n.login-btn {\r\n  width: 100%;\r\n  margin-bottom: 30px;\r\n}\r\n.show-pwd {\r\n    position: absolute;\r\n    right: 10px;\r\n    top: 18px;\r\n    font-size: 16px;\r\n    color: $dark_gray;\r\n    cursor: pointer;\r\n    -webkit-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n}\r\n</style>\r\n\r\n<style lang=\"scss\">\r\n//css 样式重置 增加个前缀避免全局污染\r\n.login-container {\r\n  .el-input__wrapper {\r\n    background-color: transparent;\r\n    box-shadow: none;\r\n    width: 100%;\r\n  }\r\n  .el-form-item {\r\n    border: 1px solid rgba(255, 255, 255, 0.1);\r\n    background: rgba(0, 0, 0, 0.1);\r\n    border-radius: 5px;\r\n    color: #454545;\r\n  }\r\n  .el-input input {\r\n    background: transparent;\r\n    border: 0px;\r\n    -webkit-appearance: none;\r\n    border-radius: 0px;\r\n    padding: 10px 5px 10px 15px;\r\n    color: #fff;\r\n    height: 42px; //此处调整item的高度\r\n    caret-color: #fff;\r\n  }\r\n  //hiden the input border\r\n  .el-input__inner {\r\n    box-shadow: none !important;\r\n  }\r\n}\r\n</style>\r\n"],"names":["deferredPrompt","ref","buttonCss","butonClick","result","onMounted","beforeInstallPrompt","evt","event","platform","_instance","settings","useBasicStore","route","useRoute","formRules","useElement","subForm","reactive","state","openQR","dataUrl","id","getOtherQuery","query","acc","cur","watch","subLoading","tipMessage","refLoginForm","handleLogin","valid","loginFunc","router","useRouter","basicStore","passwordType","refPassword","showPwd","nextTick"],"mappings":"ocAgBA,MAAAA,EAAAC,EAAA,IAAA,EACAC,EAAAD,EAAA,EAAA,EACAE,EAAA,SAAA,CACA,GAAA,CAAAH,EAAA,MACA,OAEA,MAAAI,EAAA,MAAAJ,EAAA,MAAA,OAAA,EACA,QAAA,IAAA,uBAAAI,EAAA,SAAA,EACAJ,EAAA,MAAA,KACA,4BACA,cAAA,aAAA,SAAA,EAAA,CACA,EACA,OAAAK,EAAA,IAAA,CAIA,0BAAA,SACA,QAAA,IAAA,IAAA,EACA,OAAA,iBAAA,sBAAAC,IAGA,SAAAA,EAAAC,EAAA,CACAA,EAAA,eAAA,CACA,CAEA,OAAA,iBAAA,sBAAAC,GAAA,CACA,QAAA,IAAA,IAAAA,CAAA,EACAA,EAAA,eAAA,EACAR,EAAA,MAAAQ,EACAN,EAAA,MAAA,EAEA,CAAA,EACA,OAAA,kBACA,IAAA,gBAAA,CACA,aAAA,SAAAO,EAAAC,EAAA,CAEA,QAAA,IAAA,MAAAA,CAAA,CACA,EACA,sBAAA,SAAAD,EAAA,CAEA,QAAA,IAAA,kBAAAA,EACA,CACA,GAEA,CAAA,4cCPI,KAAA,CAAA,SAAAE,CAAA,EAAAC,EAAA,EACJC,EAAAC,EAAA,EAEAC,EAAAC,GAAA,EAAA,UAEAC,EAAAC,EAAA,CACA,QAAA,QACA,SAAA,QACA,CAAA,EACAC,EAAAD,EAAA,CACA,WAAA,CAAA,EACA,SAAA,MACA,CAAA,EACAE,EAAA,CAAAC,EAAAC,IAAA,CACA,QAAA,IAAA,KAAA,CACA,EACAC,EAAAC,GACA,OAAA,KAAAA,CAAA,EAAA,OAAA,CAAAC,EAAAC,KACAA,IAAA,aACAD,EAAAC,GAAAF,EAAAE,IAEAD,GACA,EAAA,EAGAE,EAAA,IAAAd,EAAA,MAAAW,GAAA,CACAA,IACAL,EAAA,SAAAK,EAAA,SACAL,EAAA,WAAAI,EAAAC,CAAA,EAEA,EACA,CAAA,UAAA,EAAA,CACA,EAKA,IAAAI,EAAA3B,EAAA,EAAA,EAEA4B,EAAA5B,EAAA,EAAA,EAEA,MAAA6B,EAAA7B,EAAA,IAAA,EACA8B,EAAA,IAAA,CACAD,EAAA,MAAA,SAAAE,GAAA,CACAJ,EAAA,GACAI,GAAAC,EAAA,CACA,CAAA,CACA,EACAC,EAAAC,GAAA,EACAC,EAAAxB,EAAA,EAEAqB,EAAA,IAAA,CACAG,EAAA,SAAA,EAAA,EACAF,EAAA,KAAA,GAAA,CACA,EAKAG,EAAApC,EAAA,UAAA,EACAqC,EAAArC,EAAA,IAAA,EACAsC,EAAA,IAAA,CACAF,EAAA,QAAA,WACAA,EAAA,MAAA,GAEAA,EAAA,MAAA,WAEAG,EAAA,IAAA,CACAF,EAAA,MAAA,MAAA,CACA,CAAA,CACA"}